sql.jdbc.query.timeout=60

## Polizas ##
sql.poliza.listado.count=SELECT COUNT(S_ASSET.ROW_ID) FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID 
sql.poliza.listado.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza , S_ASSET.START_DT AS fechaEfectoDesde, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, CASE WHEN  S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' THEN S_CONTACT.X_DNI ELSE NULL END AS nifTomador, S_POSTN.NAME AS  codigoMediador, S_ASSET.TYPE_CD as tipoProducto, CASE WHEN X_FRECUENCIA='IRREGULAR' OR X_FRECUENCIA='ANUAL' OR X_FRECUENCIA='PAGO UNICO' THEN X_PRIMA_NETA    ELSE CASE WHEN X_FRECUENCIA='MENSUAL' THEN X_PRIMA_NETA*12        ELSE CASE WHEN X_FRECUENCIA='TRIMESTRAL' THEN X_PRIMA_NETA*4            ELSE CASE WHEN X_FRECUENCIA='SEMESTRAL' THEN X_PRIMA_NETA*2            END       END    END END primaTotalAnualizada, S_ASSET.STATUS_CD AS estado FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID
sql.poliza.listado.orderby= ORDER BY S_ASSET.START_DT DESC 
sql.poliza.validate.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_POSTN WHERE S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_ASSET.REV_NUM='0'  
sql.poliza.detalle.vida.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.LAST_UPD AS ultimaModificacion, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_POSTN.NAME AS  codigoMediador, S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate, CASE WHEN S_PROD_INT.NAME='4299' THEN CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365<1 THEN 0     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>1 and (SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97     ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR     ELSE 0 END END END END END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365<1 THEN 0 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>1 and (SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97 ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END END END END END) END ELSE CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) END  END AS valorRescateSinPB, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe, S_ASSET. X_ANEXOS_HOST AS anexosHost, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta, CASE WHEN S_PROD_INT.NAME<>'4246' THEN 'Y' ELSE 'N' END AS valorRescateCalculado, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT, SIEBEL.S_FN_ACCNT2_FNX, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_ASSET_X WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='VIDA' AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.ROW_ID=S_ASSET_X.ROW_ID(+) AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' 
sql.poliza.detalle.notype.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.LAST_UPD AS ultimaModificacion, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_POSTN.NAME AS  codigoMediador, S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate, CASE WHEN S_PROD_INT.NAME='4299' THEN CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365<1 THEN 0     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>1 and (SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97     ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR     ELSE 0 END END END END END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365<1 THEN 0 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>1 and (SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97 ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END END END END END) END ELSE CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) END  END AS valorRescateSinPB, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe, S_ASSET. X_ANEXOS_HOST AS anexosHost, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta, CASE WHEN S_PROD_INT.NAME<>'4246' THEN 'Y' ELSE 'N' END AS valorRescateCalculado, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT, SIEBEL.S_FN_ACCNT2_FNX, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_ASSET_X WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD IS NULL AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.ROW_ID=S_ASSET_X.ROW_ID(+) AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR'
sql.poliza.detalle.decesos.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.LAST_UPD AS ultimaModificacion, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_POSTN.NAME AS  codigoMediador, S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate, CASE WHEN S_PROD_INT.NAME='4299' THEN CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365<1 THEN 0     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>1 and (SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95     ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97     ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR     ELSE 0 END END END END END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365<1 THEN 0 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>1 and (SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95 ELSE CASE WHEN S_PROD_INT.NAME='4249' and (SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97 ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END END END END END) END ELSE CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) END  END AS valorRescateSinPB, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe, S_ASSET. X_ANEXOS_HOST AS anexosHost, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta, CASE WHEN S_PROD_INT.NAME<>'4246' THEN 'Y' ELSE 'N' END AS valorRescateCalculado, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT, SIEBEL.S_FN_ACCNT2_FNX, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_ASSET_X WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='DECESOS' AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.ROW_ID=S_ASSET_X.ROW_ID(+) AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR'
sql.poliza.detalle.rector.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza,S_ASSET.VERSION AS digitoControl,S_PROD_INT.NAME AS codigoModalidad,S_PROD_INT.ALIAS_NAME AS descrModalidad,S_PROD_INT.ALIAS_NAME AS tipoProducto,S_PROD_INT.DETAIL_TYPE_CD AS ramo,S_ASSET.LAST_UPD AS ultimaModificacion,S_ASSET.STATUS_CD AS estadoPoliza,S_ASSET.COMMENTS AS descripcionEstado,S_ASSET.START_DT AS fechaEfecto,S_ASSET.X_F_BAJA AS fechaBaja,S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja,S_ASSET.END_DT AS fechaVencimiento,S_ASSET.PREMIUM AS primaRecibo,S_POSTN.NAME AS codigoMediador,S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate,CASE WHEN S_PROD_INT.NAME='4299' THEN CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365<1 THEN 0 ELSE CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93 ELSE CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365>1 AND(SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95 ELSE CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97 ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END END END END END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365<1 THEN 0 ELSE CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365=1 THEN 0.93 ELSE CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365>1 AND(SYSDATE-S_ASSET.START_DT)/365<=10 THEN 0.95 ELSE CASE WHEN S_PROD_INT.NAME='4249' AND(SYSDATE-S_ASSET.START_DT)/365>10 THEN 0.97 ELSE CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END END END END END) END ELSE CASE WHEN S_ASSET_X.ATTRIB_04<S_ASSET_X.ATTRIB_03 THEN S_ASSET_X.ATTRIB_14*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) ELSE S_ASSET_X.ATTRIB_15*(CASE WHEN (SYSDATE-S_ASSET.START_DT)/365>=2 THEN S_PROD_INT.UNIT_CONV_FACTOR ELSE 0 END) END END AS valorRescateSinPB,S_CONTACT.LAST_NAME AS codigoTomador,S_CONTACT.X_NOMBRE AS nombreTomador,S_CONTACT.X_APELLIDOS AS apellidosTomador,S_CONTACT.X_DEN_S AS razonSocialTomador,S_CONTACT.X_DNI AS nifTomador,S_CONTACT.X_T_PER AS tipoTomadorPersona,S_CONTACT.BIRTH_DT AS fechaNacimiento,S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe,S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe,S_CONTACT.X_CP AS codigoPostalTomadorParticipe,S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe,S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe,S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe,S_ASSET. X_ANEXOS_HOST AS anexosHost,CUENTA.X_OFICINA AS codigoSucursalCuenta,CUENTA.X_SUCURSAL AS codigoEntidadCuenta,CUENTA.X_DC AS digitoControlCuenta,CUENTA.X_CUENTA AS codigoCuenta,CASE WHEN S_PROD_INT.NAME<>'4246' THEN 'Y' ELSE 'N' END AS valorRescateCalculado,S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET,SIEBEL.S_ASSET_CON,SIEBEL.S_CONTACT,SIEBEL.S_POSTN,SIEBEL.S_PROD_INT,SIEBEL.S_FN_ACCNT2_FNX,SIEBEL.S_INS_BILLACCT CUENTA,SIEBEL.S_ASSET_X WHERE  S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='RECTOR' AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+)AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.ROW_ID=S_ASSET_X.ROW_ID(+) AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' 
sql.poliza.detalle.vidaahorro.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.LAST_UPD AS ultimaModificacion, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_ASSET.X_FRECUENCIA AS frecuenciaPeriodicidadPago, S_POSTN.NAME AS  codigoMediador, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe,  S_ASSET.ASSET_VALUE_AMT AS valorPoliza, S_FN_ACCNT2_FNX.SA_LAST_STAT_DT AS fUltParticipBeneficios, S_ASSET.INCEPTION_DT AS fechaValoracion, S_ASSET. X_ANEXOS_HOST AS anexosHost, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta,  S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate, S_FN_ACCNT2_FNX.MIN_INTR_RATE AS porcentajeInteresGarantizado, S_FN_ACCNT2_FNX.DIVDND_ACCUM AS participacionBeneficios, S_ASSET.ORIGINAL_COST AS importeTotalPrimasPagadas, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_FN_ACCNT2_FNX WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='VIDA AHORRO' AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) 
sql.poliza.detalle.unitlinked.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.LAST_UPD AS ultimaModificacion, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_ASSET.X_FRECUENCIA AS frecuenciaPeriodicidadPago, S_ASSET.ORIGINAL_COST AS importeTotalAportado, S_ASSET.ASSET_VALUE_AMT AS valorPoliza, S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate, S_ASSET.INCEPTION_DT AS fechaValoracion, S_POSTN.NAME AS codigoMediador, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_FN_ACCNT2_FNX WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='UNIT-LINKED' AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+) AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) 
sql.poliza.detalle.planespensiones.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_ASSET.LAST_UPD AS ultimaModificacion, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_ASSET.X_FRECUENCIA AS frecuenciaPeriodicidadPago, S_ASSET.ORIGINAL_COST AS importeTotalAportado, S_ASSET.ASSET_VALUE_AMT AS valorPlanAFechaConsulta, S_POSTN.NAME AS codigoMediador, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe, S_ASSET.X_PIGNO AS pignoraciones, S_ASSET.X_ANEXOS_HOST AS anexosHost, SUM (S_FN_HLDNG.QTY) AS numeroParticipaciones, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta, S_ASSET.INCEPTION_DT AS fechaValoracion, S_FN_ACCNT2_FNX.SURRENDER_VALUE AS valorRescate, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_POSTN, SIEBEL.S_PROD_INT, SIEBEL.S_FN_HLDNG,SIEBEL.S_FN_ACCNT2_FNX WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='PLANES DE PENSIONES' AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+) AND S_ASSET.ROW_ID=S_FN_HLDNG.ASSET_ID (+) AND S_ASSET.ROW_ID=S_FN_ACCNT2_FNX.ROW_ID (+)  
sql.poliza.detalle.salud.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_ASSET.VERSION AS digitoControl, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS descrModalidad, S_PROD_INT.ALIAS_NAME AS tipoProducto, S_PROD_INT.DETAIL_TYPE_CD AS ramo, S_ASSET.LAST_UPD AS ultimaModificacion, S_ASSET.STATUS_CD AS estadoPoliza, S_ASSET.COMMENTS AS descripcionEstado, S_ASSET.START_DT AS fechaEfecto, S_ASSET.X_F_BAJA AS fechaBaja, S_ASSET.X_DES_MOTIVO_ANULA AS motivoBaja, S_ASSET.END_DT AS fechaVencimiento, S_ASSET.PREMIUM AS primaRecibo, S_ASSET.X_FRECUENCIA AS frecuenciaPeriodicidadPago, CASE WHEN X_FRECUENCIA='IRREGULAR' OR X_FRECUENCIA='ANUAL' OR X_FRECUENCIA='PAGO UNICO' THEN X_PRIMA_NETA    ELSE CASE WHEN X_FRECUENCIA='MENSUAL' THEN X_PRIMA_NETA*12        ELSE CASE WHEN X_FRECUENCIA='TRIMESTRAL' THEN X_PRIMA_NETA*4            ELSE CASE WHEN X_FRECUENCIA='SEMESTRAL' THEN X_PRIMA_NETA*2            END        END    END END primaTotalAnualizada, S_POSTN.NAME AS  codigoMediador, S_CONTACT.LAST_NAME AS codigoTomador, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador,  S_CONTACT.X_DNI AS nifTomador, S_CONTACT.X_T_PER AS tipoTomadorPersona, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_TIPO_VIA AS tipoViaTomadorParticipe, S_CONTACT.X_DIRECCION AS domicilioTomadorParticipe, S_CONTACT.X_CP AS codigoPostalTomadorParticipe, S_CONTACT.X_CIUDAD AS ciudadTomadorParticipe, S_CONTACT.X_PROVINCIA AS provinciaTomadorParticipe, S_CONTACT.HOME_PH_NUM AS telefonoTomadorParticipe, S_ASSET.X_IMPUESTOS AS impuestos, S_ASSET.X_IPS AS ips, S_ASSET.X_PRIMA_NETA AS primaNeta, CUENTA.X_OFICINA AS codigoSucursalCuenta, CUENTA.X_SUCURSAL AS codigoEntidadCuenta, CUENTA.X_DC AS digitoControlCuenta, CUENTA.X_CUENTA AS codigoCuenta, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_INS_BILLACCT CUENTA, SIEBEL.S_PROD_INT WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_PROD_INT.NAME=S_ASSET.X_PRODUCTO AND S_ASSET.TYPE_CD='SALUD' AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_ASSET.BILLACCT_ID=CUENTA.ROW_ID(+)
sql.poliza.detalle.planespensiones.groupby= GROUP BY S_ASSET.ASSET_NUM, S_ASSET.VERSION, S_PROD_INT.NAME, S_PROD_INT.ALIAS_NAME, S_ASSET.LAST_UPD, S_PROD_INT.DETAIL_TYPE_CD, S_ASSET.STATUS_CD, S_ASSET.COMMENTS, S_ASSET.START_DT, S_ASSET.X_F_BAJA, S_ASSET.X_DES_MOTIVO_ANULA, S_ASSET.END_DT, S_ASSET.PREMIUM, S_ASSET.X_FRECUENCIA, S_ASSET.ORIGINAL_COST, S_ASSET.ASSET_VALUE_AMT, S_FN_ACCNT2_FNX.SURRENDER_VALUE, S_ASSET.INCEPTION_DT, S_POSTN.NAME, S_CONTACT.LAST_NAME, S_CONTACT.X_NOMBRE, S_CONTACT.X_APELLIDOS, S_CONTACT.X_DEN_S, S_CONTACT.X_DNI, S_CONTACT.X_T_PER, S_CONTACT.BIRTH_DT, S_CONTACT.X_TIPO_VIA, S_CONTACT.X_DIRECCION, S_CONTACT.X_CP, S_CONTACT.X_CIUDAD, S_CONTACT.X_PROVINCIA, S_CONTACT.HOME_PH_NUM, S_ASSET.X_ANEXOS_HOST, S_ASSET.X_PIGNO, CUENTA.X_OFICINA, CUENTA.X_SUCURSAL,CUENTA.X_DC, CUENTA.X_CUENTA, S_FN_ACCNT2_FNX.SURRENDER_VALUE, S_ASSET.TYPE_CD

## Polizas Beneficiarios
sql.poliza.detalle.beneficiarios.select=SELECT S_ASSET.X_B_VIDA AS beneficiariosVida, S_ASSET.X_DESC_VIDA AS descBeneficiariosVida, S_ASSET.X_B_MUERTE AS beneficiariosFallecimiento, S_ASSET.X_DESC_MUERTE AS descBeneficiariosFallecimiento, S_ASSET.X_PIGNO AS indicadorPignoraciones FROM SIEBEL.S_ASSET WHERE S_ASSET.REV_NUM='0' AND S_ASSET.ASSET_NUM = ?  

## Polizas Traspasos ##
sql.traspasospolizas.listado.select=SELECT S_ASSET.ASSET_NUM AS numPoliza, S_FN_ASSET_TXFR.REF_NUM AS numTraspaso, S_FN_ASSET_TXFR.TYPE_CD AS tipoTraspaso, ORIGEN.DESC_TEXT AS gestoraOrigen, DESTINO.DESC_TEXT AS gestoraDestino, S_FN_ASSET_TXFR.TXFR_AMOUNT AS importe, S_FN_ASSET_TXFR.START_DATE AS fechaSolicitud, S_FN_ASSET_TXFR.EXCH_DT AS fechaEnvio, X_F_LIMITE AS fechaLimite, X_F_RECEP AS fechaRecepcion, TXFR_TO_CD AS estado FROM SIEBEL.S_FN_ASSET_TXFR, SIEBEL.S_ASSET, SIEBEL.S_CHRCTR ORIGEN, SIEBEL.S_CHRCTR DESTINO WHERE S_ASSET.ROW_ID=S_FN_ASSET_TXFR.ASSET_ID (+) AND S_ASSET.TYPE_CD='PLANES DE PENSIONES' AND S_ASSET.REV_NUM='0' AND S_FN_ASSET_TXFR.X_GESTORA_ORIGEN = ORIGEN.NAME AND S_FN_ASSET_TXFR.TXFR_FROM_CD = DESTINO.NAME
sql.traspasospolizas.listado.count=SELECT COUNT(S_FN_ASSET_TXFR.ROW_ID) FROM SIEBEL.S_FN_ASSET_TXFR, SIEBEL.S_ASSET, SIEBEL.S_CHRCTR ORIGEN, SIEBEL.S_CHRCTR DESTINO WHERE S_ASSET.ROW_ID=S_FN_ASSET_TXFR.ASSET_ID (+) AND S_ASSET.TYPE_CD='PLANES DE PENSIONES' AND S_ASSET.REV_NUM='0' AND S_FN_ASSET_TXFR.X_GESTORA_ORIGEN = ORIGEN.NAME AND S_FN_ASSET_TXFR.TXFR_FROM_CD = DESTINO.NAME
sql.traspasospolizas.listado.orderby= ORDER BY S_FN_ASSET_TXFR.REF_NUM DESC  

## Polizas Unit Link Fondos ##
sql.fondosunitlink.listado.select=SELECT S_PROD_INT.ALIAS_NAME AS nombreFondo, S_FN_HLDNG.COUPON_PERCENT AS numeroParticipantes, CASE WHEN S_PROD_INT.NAME='0700' OR S_PROD_INT.NAME='0711'         THEN S_FN_HLDNG.MARKET_VALUE* S_FN_HLDNG.COUPON_PERCENT         ELSE S_PROD_INT.X_VALOR_COTIZA*S_FN_HLDNG.COUPON_PERCENT END AS valorTotal, S_PROD_INT.X_FECHA_COTIZA AS fechaActualFechaValoracion, S_FN_HLDNG.PERCENTAGE_PREM AS porcentajeDistribucion, S_FN_HLDNG.MARKET_VALUE AS valorCUCuenta, S_FN_HLDNG.MATURITY_DT AS fechaValorCUCuenta FROM SIEBEL.S_FN_HLDNG, SIEBEL.S_PROD_INT, SIEBEL.S_ASSET WHERE S_FN_HLDNG.PROD_ID=S_PROD_INT.ROW_ID AND S_FN_HLDNG.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET.REV_NUM='0' 
sql.fondosunitlink.listado.count=SELECT COUNT(*) FROM SIEBEL.S_FN_HLDNG, SIEBEL.S_PROD_INT, SIEBEL.S_ASSET WHERE S_FN_HLDNG.PROD_ID=S_PROD_INT.ROW_ID AND S_FN_HLDNG.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET.REV_NUM='0'
sql.fondosunitlink.detalle.select=SELECT S_PROD_INT.ALIAS_NAME  AS nombreFondo, S_PROD_INT.PART_NUM  AS codigoFondo, S_PROD_INT.X_NACION AS nacionAperturaFondo, S_PROD_INT.X_VALOR_APER AS valorAperturaFondo, S_PROD_INT.X_FECHA_APER AS fechaAperturaFondo, S_PROD_INT.X_VALOR_COTIZA AS valorActualFondo, S_PROD_INT.X_FECHA_COTIZA AS fechaValorActualFondo, CASE WHEN S_PROD_INT.X_VALOR_COTIZA='' OR S_PROD_INT.X_VALOR_APER=''  	THEN 0 	ELSE ((S_PROD_INT.X_VALOR_COTIZA-S_PROD_INT.X_VALOR_APER)/S_PROD_INT.X_VALOR_APER)*100 	END AS rentabilidadActual, S_PROD_INT.X_RENTA_3A AS rentabilidad1Anio, S_PROD_INT.X_RENTA_5A AS rentabilidad3Anios, S_PROD_INT.X_RENTA_8A AS rentabilidad5Anios, S_PROD_INT.X_RENTA_12A AS rentabilidad8Anios FROM SIEBEL.S_PROD_INT WHERE S_PROD_INT.PROD_CD='Security'

## Polizas Planes Pensiones Fondos ##
sql.fondosplanpens.detalle.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_PROD_INT.ALIAS_NAME AS nombreFondo, S_PROD_INT.PART_NUM AS codigoFondo, S_FN_HLDNG.COUPON_PERCENT AS numeroParticipaciones, CASE WHEN S_PROD_INT.NAME='0700' OR S_PROD_INT.NAME='0711' 	THEN S_FN_HLDNG.MARKET_VALUE* S_FN_HLDNG.COUPON_PERCENT ELSE S_PROD_INT.X_VALOR_COTIZA*S_FN_HLDNG.COUPON_PERCENT END AS impDerechosConsolidados FROM SIEBEL.S_ASSET, SIEBEL.S_FN_HLDNG, SIEBEL.S_PROD_INT WHERE S_ASSET.ROW_ID=S_FN_HLDNG.ASSET_ID(+) AND S_ASSET.TYPE_CD='PLANES DE PENSIONES' AND S_FN_HLDNG.PROD_ID=S_PROD_INT.ROW_ID AND S_PROD_INT.PROD_CD='Security' AND S_PROD_INT.ROW_ID=S_FN_HLDNG.PROD_ID AND S_ASSET.REV_NUM='0'

## Polizas Evolucion Fondos Unit Link ##
sql.evolucionfondosunitlink.listado.select=SELECT TERM_CD AS fechaValorFondo, PER_SHARE_AMT AS cotizacionFondo FROM SIEBEL.S_FNSEC_ERNG, SIEBEL.S_PROD_INT WHERE S_PROD_INT.PROD_CD='Security' AND S_PROD_INT.ROW_ID=S_FNSEC_ERNG.PROD_ID (+)
sql.evolucionfondosunitlink.listado.count=SELECT COUNT(*) FROM SIEBEL.S_FNSEC_ERNG, SIEBEL.S_PROD_INT WHERE S_PROD_INT.PROD_CD='Security' AND S_PROD_INT.ROW_ID=S_FNSEC_ERNG.PROD_ID (+)     
sql.evolucionfondosunitlink.listado.groupby= ORDER BY TERM_CD DESC 

## Polizas Fondos Vida Ahorro
sql.poliza.fondos.vidaahorro.listado.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_PROD_INT.NAME AS codigoFondo, S_PROD_INT.ALIAS_NAME AS nombreFondo, S_PROD_INT.X_NACION AS lugarApertura, S_PROD_INT.X_VALOR_APER AS valorApertura, S_PROD_INT.X_FECHA_APER AS fechaApertura, S_PROD_INT.X_VALOR_COTIZA AS valorActual, S_PROD_INT.X_FECHA_COTIZA AS fechaValor FROM SIEBEL.S_ASSET, SIEBEL.S_FN_HLDNG, SIEBEL.S_PROD_INT WHERE S_FN_HLDNG.ASSET_ID=S_ASSET.ROW_ID AND S_FN_HLDNG.PROD_ID=S_PROD_INT.ROW_ID 

## Polizas Aportaciones ##
sql.poliza.aportaciones.listado.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_FN_ACCNT_TXN.TXN_REF_NUM AS numeroRecibo, S_FN_ACCNT_TXN.TXN_DT AS fechaValor, S_FN_ACCNT_TXN.AMT AS importeAportacion, S_FN_ACCNT_TXN.X_COMISION AS importeComisionAportacion, S_FN_ACCNT_TXN.ITEM_TYPE_CD AS tipoAportacion, S_FN_ACCNT_TXN.X_F_CONTA AS fechaContabilizacion FROM SIEBEL.S_ASSET, SIEBEL.S_FN_ACCNT_TXN WHERE S_ASSET.TYPE_CD='PLANES DE PENSIONES' AND S_FN_ACCNT_TXN.ORDER_CD = 'APORTACION' AND S_ASSET.ROW_ID=S_FN_ACCNT_TXN.ACCNT_ID(+) AND S_ASSET.REV_NUM='0' AND S_FN_ACCNT_TXN.STATUS_CD <> 'ANULACION'
sql.poliza.aportaciones.count.select=SELECT COUNT(*) FROM SIEBEL.S_ASSET, SIEBEL.S_FN_ACCNT_TXN WHERE S_ASSET.TYPE_CD='PLANES DE PENSIONES' AND S_FN_ACCNT_TXN.ORDER_CD = 'APORTACION' AND S_ASSET.ROW_ID=S_FN_ACCNT_TXN.ACCNT_ID(+) AND S_ASSET.REV_NUM='0' AND S_FN_ACCNT_TXN.X_F_CONTA IS NOT NULL AND S_FN_ACCNT_TXN.STATUS_CD <> 'ANULACION'

## Recibos ##
sql.recibos.listado.select=SELECT S_PAY_PLAN.PLAN_NUM AS numeroRecibo, S_PAY_PLAN.X_E_RECIBO AS estadoRecibo, S_PAY_PLAN.FREQUENCY AS periodoRecibo, S_PAY_PLAN.BEGIN_DT AS fechaEfecto, S_PAY_PLAN.END_DT AS fechaVencimiento, S_PAY_PLAN.AMOUNT AS importeTotalRecibo, S_PAY_PLAN.X_P_NETA AS primaNetaRecibo, S_PAY_PLAN.FEES AS importeComisiones, S_PAY_PLAN.X_COD_AGENTE AS codigoMediacion, S_ASSET.ASSET_NUM AS numeroPoliza FROM SIEBEL.S_PAY_PLAN, SIEBEL.S_ASSET WHERE S_ASSET.ROW_ID=S_PAY_PLAN.ASSET_ID  
sql.recibos.count.select=SELECT COUNT(S_PAY_PLAN.ROW_ID) FROM SIEBEL.S_PAY_PLAN, SIEBEL.S_ASSET WHERE S_ASSET.ROW_ID=S_PAY_PLAN.ASSET_ID  
sql.recibos.listado.orderby= ORDER BY S_PAY_PLAN.DUE_DT DESC 
sql.recibos.detalle.select=SELECT S_PAY_PLAN.PLAN_NUM AS numeroRecibo, S_PAY_PLAN.PAY_SELECTION AS tipoRecibo, S_PAY_PLAN.X_E_RECIBO AS estadoRecibo, S_PAY_PLAN.FINANCE_INST AS formaPago, S_PAY_PLAN.FREQUENCY AS periodoPago, S_ASSET.ASSET_NUM AS numeroPoliza, S_PAY_PLAN.X_COD_AGENTE AS codigoMediacion, S_PAY_PLAN.DUE_DT AS fechaEmision, S_PAY_PLAN.BEGIN_DT AS fechaEfecto, S_PAY_PLAN.END_DT AS fechaVencimiento, S_PAY_PLAN.X_FECHA_EMISION AS fechaDevolucion, S_PAY_PLAN.X_MOT_DEV AS motivoDevolucion, S_PAY_PLAN.FEES AS comisionesRecibo, S_PAY_PLAN.X_TERMINALISTA AS terminalista, S_PAY_PLAN.X_T_RECIBO AS numeroExtorno, S_PAY_PLAN.EXCH_DT AS fechaCobro, S_PAY_PLAN.AMOUNT AS importeTotalRecibo, S_PAY_PLAN.X_P_BONIF AS importeBonificacion, S_PAY_PLAN.X_CONSORCIO AS importeConsorcio, S_PAY_PLAN.X_IPS AS importeIPS, S_PAY_PLAN.X_T_IMPUESTOS AS importeTotalImpuestos, S_PAY_PLAN.X_OMS AS descuento, S_PAY_PLAN.X_P_NETA AS primaNeta, S_PAY_PLAN.X_PROD_VCTO AS produccionCartera, S_PAY_PLAN.EXPIRATION_DT AS fechaAnulacion, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS razonSocialTomador, S_CONTACT.SUPPRESS_CALL_FLG as cancelacionDatos FROM SIEBEL.S_PAY_PLAN, SIEBEL.S_ASSET, SIEBEL.S_CONTACT WHERE S_ASSET.ROW_ID=S_PAY_PLAN.ASSET_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID  

## Clientes ##
sql.clientes.count.select=SELECT COUNT(S_CONTACT.ROW_ID) FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_POSTN, SIEBEL.S_CONTACT WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID
sql.clientes.listado.select=SELECT S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellido, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.X_DNI AS nif, S_POSTN.NAME AS codMediacionAsoc, S_CONTACT.LAST_NAME AS codInterviniente FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_POSTN, SIEBEL.S_CONTACT WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID
sql.clientes.listado.groupby=GROUP BY S_CONTACT.X_NOMBRE , S_CONTACT.X_APELLIDOS , S_CONTACT.BIRTH_DT , S_CONTACT.X_DEN_S , S_CONTACT.X_DNI , S_POSTN.NAME , S_CONTACT.LAST_NAME
sql.clientes.detalle.select=SELECT  S_CONTACT.LAST_NAME AS codCliente, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_PROFESION AS profesionCliente, S_CONTACT.X_APELLIDOS AS apellido, S_CONTACT.X_DEN_S AS razonSocial, S_POSTN.NAME AS codMediacionAsoc, S_CONTACT.X_DNI AS nif, S_CONTACT.SEX_MF AS sexo, S_CONTACT.SUPPRESS_CALL_FLG AS sLlamado, S_CONTACT.SUPPRESS_MAIL_FLG AS sCorreo, S_CONTACT.X_TIPO_VIA AS tipoVia, S_CONTACT.X_DIRECCION AS domicilio, S_CONTACT.X_CP AS codPostalDomicilio, S_CONTACT.X_CIUDAD AS ciudadDomicilio, S_CONTACT.X_PROVINCIA AS provinciaDomicilio, S_CONTACT.X_T_CONT AS tipoContacto, S_CONTACT.X_T_PER AS tipoPersona, S_CONTACT.MARITAL_STAT_CD AS estadoCivil, S_CONTACT.HOME_PH_NUM AS telContacto1, S_CONTACT.X_DESC_1 AS descTelContacto1, S_CONTACT.WORK_PH_NUM AS telContacto2, S_CONTACT.X_DESC_2 AS descTelContacto2, S_CONTACT.CELL_PH_NUM AS telMovil, S_CONTACT.FAX_PH_NUM AS fax, S_CONTACT.EMAIL_ADDR AS email, S_CONTACT.SUPPRESS_CALL_FLG as cancelacionDatos FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_POSTN, SIEBEL.S_CONTACT WHERE 	S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' 	AND S_ASSET_CON.RELATION_TYPE_CD='TOMADOR' AND S_POSTN.ROW_ID=S_ASSET.PR_POSTN_ID AND S_CONTACT.X_DNI = ?  

## Codigos Mediacion ##
sql.codmediacion.listado.select=SELECT DISTINCT MEDIADOR.NAME AS codigo FROM SIEBEL.S_POSTN MEDIADOR, SIEBEL.S_POSTN DIRECTOR, SIEBEL.S_ORG_INT OFICINA, SIEBEL.S_ORG_INT TERRITORIO, SIEBEL.S_ORG_INT RED WHERE DIRECTOR.ROW_ID=MEDIADOR.PAR_POSTN_ID AND OFICINA.ROW_ID=MEDIADOR.OU_ID AND TERRITORIO.ROW_ID=OFICINA.PAR_OU_ID AND RED.ROW_ID=TERRITORIO.PAR_OU_ID

## Cuenta Bancaria ##
sql.cuentabancaria.listado.select=SELECT S_CONTACT.X_DNI AS nif, S_INS_BILLACCT.X_CUENTA AS numCuenta, S_INS_BILLACCT.X_DC AS dc, S_INS_BILLACCT.X_OFICINA AS codSucursal, S_INS_BILLACCT.X_SUCURSAL AS codEntidad, S_EMPLOYEE.LOGIN as codMediacionAsoc  FROM  SIEBEL.S_ASSET, SIEBEL.S_INS_BILLACCT, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE  WHERE  S_ASSET.BILLACCT_ID=S_INS_BILLACCT.ROW_ID AND S_INS_BILLACCT.PR_CON_ID=S_CONTACT.ROW_ID  AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID  AND S_ASSET.SHIP_DT IS NULL 
sql.cuentabancaria.count.select=SELECT COUNT(*) FROM (SELECT S_CONTACT.X_DNI AS nif, S_INS_BILLACCT.X_CUENTA AS numCuenta, S_INS_BILLACCT.X_DC AS dc, S_INS_BILLACCT.X_OFICINA AS codSucursal, S_INS_BILLACCT.X_SUCURSAL AS codEntidad, S_EMPLOYEE.LOGIN as codMediacionAsoc  FROM  SIEBEL.S_ASSET, SIEBEL.S_INS_BILLACCT, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE  WHERE  S_ASSET.BILLACCT_ID=S_INS_BILLACCT.ROW_ID AND S_INS_BILLACCT.PR_CON_ID=S_CONTACT.ROW_ID  AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID  AND S_ASSET.SHIP_DT IS NULL
sql.cuentabancaria.numpoliza.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_INS_BILLACCT, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE  WHERE    S_ASSET.BILLACCT_ID=S_INS_BILLACCT.ROW_ID AND S_INS_BILLACCT.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.SHIP_DT IS NULL
sql.cuentabancaria.listado.groupby= GROUP BY S_CONTACT.X_DNI, S_INS_BILLACCT.X_CUENTA, S_INS_BILLACCT.X_DC, S_INS_BILLACCT.X_OFICINA, S_INS_BILLACCT.X_SUCURSAL, S_EMPLOYEE.LOGIN
sql.cuentabancaria.numpoliza.groupby= GROUP BY S_ASSET.ASSET_NUM  

## Cuenta Efectivo ##
sql.cuentaefectivo.listado.select=SELECT S_EMPLOYEE_XM.ATTRIB_04 AS codMediador, S_EMPLOYEE_XM.ATTRIB_06 AS mes, S_EMPLOYEE_XM.ATTRIB_07 AS anio, S_EMPLOYEE_XM.ATTRIB_18 AS saldoInicial,  S_EMPLOYEE_XM.ATTRIB_24 AS saldoAcumulado FROM  SIEBEL.S_EMPLOYEE_XM WHERE  S_EMPLOYEE_XM.TYPE = 'ACUMULADO'
sql.cuentaefectivo.listado.orderby= ORDER BY S_EMPLOYEE_XM.ATTRIB_07 DESC, S_EMPLOYEE_XM.ATTRIB_06 DESC
sql.cuentaefectivo.count.select=SELECT COUNT(*) FROM  SIEBEL.S_EMPLOYEE_XM WHERE  S_EMPLOYEE_XM.TYPE = 'ACUMULADO' 
sql.cuentaefectivo.detalle.select=SELECT S_EMPLOYEE_XM.ATTRIB_04 AS codMediador, S_EMPLOYEE_XM.ATTRIB_06 AS mes, S_EMPLOYEE_XM.ATTRIB_07 AS anio, S_EMPLOYEE_XM.ATTRIB_18 AS saldoInicial,  S_EMPLOYEE_XM.ATTRIB_24 AS saldoAcumulado, S_EMPLOYEE_XM.ATTRIB_17 AS totalPrimaNeta, S_EMPLOYEE_XM.ATTRIB_25 AS totalRecibos,  S_EMPLOYEE_XM.ATTRIB_19 AS totalComisiones, S_EMPLOYEE_XM.ATTRIB_16 AS totalIRPF, S_EMPLOYEE_XM.X_IMPORTE_LIQUIDAR AS totalImporteLiquido,  S_EMPLOYEE_XM.ATTRIB_09 AS aceptacion, S_EMPLOYEE_XM.ATTRIB_10 AS revision FROM  SIEBEL.S_EMPLOYEE_XM WHERE  S_EMPLOYEE_XM.TYPE='ACUMULADO' 

## Movimientos Cuenta Efectivo ##
sql.cuentaefectivo.movimientos.listado.select=SELECT S_EMPLOYEE_XM.ATTRIB_04 AS codMediacionAsoc, S_EMPLOYEE_XM.ATTRIB_41 AS tipoMovimiento, S_EMPLOYEE_XM.ATTRIB_07 AS numReferencia,  S_EMPLOYEE_XM.ATTRIB_34 AS numPoliza, S_EMPLOYEE_XM.ATTRIB_19 AS importePrimaNeta, S_EMPLOYEE_XM.ATTRIB_20 AS importeTotalRecibo, S_EMPLOYEE_XM.X_PORCEN_COMISION*100 AS comision,  CASE WHEN S_EMPLOYEE_XM.ATTRIB_22=0 THEN 0 ELSE ABS(ROUND(S_EMPLOYEE_XM.ATTRIB_23*100/S_EMPLOYEE_XM.ATTRIB_22,2)) END AS IRPF,  S_EMPLOYEE_XM.ATTRIB_18 AS importeLiquido  FROM  SIEBEL.S_EMPLOYEE_XM  WHERE  S_EMPLOYEE_XM.TYPE='MOVIMIENTOS' 
sql.cuentaefectivo.movimientos.count.select=SELECT COUNT(*) FROM SIEBEL.S_EMPLOYEE_XM  WHERE S_EMPLOYEE_XM.TYPE='MOVIMIENTOS' 
sql.cuentaefectivo.movimientos.detalle.select=SELECT S_EMPLOYEE_XM.ATTRIB_04 AS codMediacionAsoc, S_EMPLOYEE_XM.ATTRIB_38 AS mes, S_EMPLOYEE_XM.ATTRIB_39 AS anyo,  S_EMPLOYEE_XM.X_FECHA_MOV AS fechaMovimiento, S_EMPLOYEE_XM.ATTRIB_41 AS tipoMovimiento, S_EMPLOYEE_XM.ATTRIB_07 AS numReferencia,  S_EMPLOYEE_XM.ATTRIB_40 AS codModalidad, S_EMPLOYEE_XM.ATTRIB_34 AS numPoliza,  S_EMPLOYEE_XM.ATTRIB_35 AS codTomador, S_EMPLOYEE_XM.X_INICIO_EFECTO AS fechaInicioEfecto, S_EMPLOYEE_XM.X_FIN_EFECTO AS fechaFinEfecto,  S_EMPLOYEE_XM.ATTRIB_19 AS primaNeta, S_EMPLOYEE_XM.ATTRIB_20 AS importeTotalRecibo, S_EMPLOYEE_XM.ATTRIB_08 AS tipoCobro, S_EMPLOYEE_XM.ATTRIB_21 AS saldoMedio,  S_EMPLOYEE_XM.X_PORCEN_COMISION*100 AS porcComision, S_EMPLOYEE_XM.ATTRIB_22 AS importeComisionBruta, CASE WHEN S_EMPLOYEE_XM.ATTRIB_22=0 THEN 0 ELSE ABS(ROUND(S_EMPLOYEE_XM.ATTRIB_23*100/S_EMPLOYEE_XM.ATTRIB_22,2)) END AS porcIRPF,  S_EMPLOYEE_XM.ATTRIB_23 AS importeRetencion, S_EMPLOYEE_XM.ATTRIB_22+S_EMPLOYEE_XM.ATTRIB_23 AS importeComisionNeta, S_EMPLOYEE_XM.ATTRIB_18 AS importeLiquido  FROM  SIEBEL.S_EMPLOYEE_XM, SIEBEL.S_PROD_INT  WHERE  S_EMPLOYEE_XM.ATTRIB_40=S_PROD_INT.NAME(+) AND S_EMPLOYEE_XM.TYPE='MOVIMIENTOS' AND S_EMPLOYEE_XM.ATTRIB_07=? 
sql.cuentaefectivo.movimientos.anios.select=SELECT DISTINCT (S_EMPLOYEE_XM.ATTRIB_39) AS anyo FROM SIEBEL.S_EMPLOYEE_XM WHERE S_EMPLOYEE_XM.TYPE='MOVIMIENTOS' ORDER BY S_EMPLOYEE_XM.ATTRIB_39 DESC 

## Mensual Cuenta Efectivo
sql.cuentaefectivo.mensual.listado.select=SELECT S_EMPLOYEE.LOGIN AS codigoMediadorAsociado, S_EMPLOYEE.X_BANCO AS banco, S_EMPLOYEE.X_SUCURSAL AS oficina, S_EMPLOYEE.X_DC AS dc, S_EMPLOYEE.X_NUM_CUENTA AS numCuenta, S_EMPLOYEE_XM.ATTRIB_06 AS mes, S_EMPLOYEE_XM.ATTRIB_07 AS anio, S_EMPLOYEE_XM.ATTRIB_24 AS saldoAcumulado, S_EMPLOYEE_XM.X_IMPORTE_SOLICITADO AS importeSolicitado, S_EMPLOYEE_XM.ATTRIB_09 AS indicadorAceptacionLiquidacion FROM SIEBEL.S_EMPLOYEE, SIEBEL.S_EMPLOYEE_XM WHERE S_EMPLOYEE.ROW_ID=S_EMPLOYEE_XM.PAR_ROW_ID AND S_EMPLOYEE_XM.TYPE='ACUMULADO' 
sql.cuentaefectivo.mensual.listado.orderby= ORDER BY S_EMPLOYEE_XM.ATTRIB_07 DESC, S_EMPLOYEE_XM.ATTRIB_06 DESC

## Garantias ##
sql.garantias.listado.select=SELECT S_APPLD_CVRG.COVERAGE_NUM AS codigoGarantia, S_APPLD_CVRG.CVRG_OPTION_CD AS descripcionGarantia, S_APPLD_CVRG.X_SUMA_ASEGU AS capitalAsegurado, S_APPLD_CVRG.PREMIUM AS importePrima, S_EMPLOYEE.LOGIN AS codigoMediacion FROM SIEBEL.S_APPLD_CVRG, SIEBEL.S_ASSET, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET.ROW_ID=S_APPLD_CVRG.ASSET_ID AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID 
sql.garantias.count.select=SELECT COUNT(*) FROM SIEBEL.S_APPLD_CVRG, SIEBEL.S_ASSET, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET.ROW_ID=S_APPLD_CVRG.ASSET_ID AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID 
sql.garantias.detalle.select=SELECT S_ASSET.ASSET_NUM AS numeroPoliza, S_APPLD_CVRG.COVERAGE_NUM AS codigoGarantia, S_APPLD_CVRG.CVRG_OPTION_CD AS descripcionGarantia, S_APPLD_CVRG.X_SUMA_ASEGU AS capitalAsegurado, S_APPLD_CVRG.PREMIUM AS importePrima, S_APPLD_CVRG.ATTRIB_02 AS tipoRevisionPrima, S_APPLD_CVRG.ATTRIB_03 AS tipoRevisionSumaAseg, S_CONTACT.LAST_NAME AS codigoSegundoAseg, S_CONTACT.X_NOMBRE AS nombreSegundoAseg, S_CONTACT.X_APELLIDOS AS apellidosSegundoAseg, S_CONTACT.X_DEN_S AS razonSocialSegundoAseg, S_CONTACT.X_DNI AS nifCifNieSegundoAseg, S_APPLD_CVRG.X_CONTROLR_PRIMA_ASEG AS controlRevalPrima, S_APPLD_CVRG.X_CONTROLR_SUMA_ASEG AS controlRevalSumaAseg, S_APPLD_CVRG.X_R_PRIMA_ASEG AS porcentajeRevalPrima, S_APPLD_CVRG.X_R_SUMA_ASEG AS porcentajeRevalSumaAseg, S_CONTACT.SEX_MF AS sexoSegundoAseg, S_CONTACT.MARITAL_STAT_CD AS estadoCivilSegundoAseg, S_CONTACT.X_PROFESION AS profesionSegundoAseg, S_CONTACT.BIRTH_DT AS fechaNaciSegundoAseg, S_ASSET_CON.ATTRIB_05 AS vinculoTomadorSegundoASeg, S_CONTACT.X_FUMA AS indicadorFumador, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_CONTACT, SIEBEL.S_APPLD_CVRG, SIEBEL.S_ASSET_CON, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET.ROW_ID=S_APPLD_CVRG.ASSET_ID AND S_APPLD_CVRG.ASSET_CON_ID=S_ASSET_CON.ROW_ID(+) AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID (+) AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID  AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID 
sql.garantias.detalle.groupby= GROUP BY S_ASSET.ASSET_NUM, S_APPLD_CVRG.COVERAGE_NUM, S_APPLD_CVRG.CVRG_OPTION_CD, S_APPLD_CVRG.X_SUMA_ASEGU, S_APPLD_CVRG.PREMIUM, S_APPLD_CVRG.ATTRIB_02, S_APPLD_CVRG.ATTRIB_03, S_CONTACT.LAST_NAME, S_CONTACT.X_NOMBRE, S_CONTACT.X_APELLIDOS, S_CONTACT.X_DEN_S, S_CONTACT.X_DNI, S_APPLD_CVRG.X_CONTROLR_PRIMA_ASEG, S_APPLD_CVRG.X_CONTROLR_SUMA_ASEG, S_APPLD_CVRG.X_R_PRIMA_ASEG, S_APPLD_CVRG.X_R_SUMA_ASEG, S_CONTACT.SEX_MF, S_CONTACT.MARITAL_STAT_CD, S_CONTACT.X_PROFESION, S_CONTACT.BIRTH_DT, S_CONTACT.X_FUMA, S_ASSET_CON.ATTRIB_05, S_ASSET.TYPE_CD 

## Intervinientes ##
#sql.intervinientes.listado.select=SELECT S_ASSET_CON.RELATION_TYPE_CD AS relacionInterviniente, S_ASSET.ASSET_NUM AS numPoliza, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellidos, S_CONTACT.X_DNI AS nif, S_CONTACT.SEX_MF AS sexo, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.X_T_CONT AS tipoContacto, S_EMPLOYEE.LOGIN as codMediacionAsoc FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT  IS NULL
sql.intervinientes.listado.select.first=SELECT S_ASSET_CON.RELATION_TYPE_CD AS relacionInterviniente, S_ASSET.ASSET_NUM AS numPoliza, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellidos, S_CONTACT.X_DNI AS nif, S_CONTACT.SEX_MF AS sexo, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.X_T_CONT AS tipoContacto, S_EMPLOYEE.LOGIN as codMediacionAsoc FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT IS NULL
sql.intervinientes.listado.select.last=SELECT S_ASSET_CON.RELATION_TYPE_CD AS relacionInterviniente, S_ASSET.ASSET_NUM AS numPoliza, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellidos, S_CONTACT.X_DNI AS nif, S_CONTACT.SEX_MF AS sexo, S_CONTACT.BIRTH_DT AS fechaNacimiento, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.X_T_CONT AS tipoContacto, S_EMPLOYEE.LOGIN as codMediacionAsoc FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.RELATION_TYPE_CD='ASEGURADO' AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT IS NULL
sql.intervinientes.listado.select.orderby=ORDER BY 2
#sql.intervinientes.count.select=SELECT COUNT(*) FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT  IS NULL
sql.intervinientes.count.select.first=SELECT COUNT(*) FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT IS NULL
sql.intervinientes.count.select.last=SELECT COUNT(*) FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.RELATION_TYPE_CD='ASEGURADO' AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT IS NULL
sql.intervinientes.count.select.orderby= ORDER BY 2 
#sql.intervinientes.detalle.select=SELECT S_ASSET.ASSET_NUM AS numPoliza, S_CONTACT.LAST_NAME AS codCliente, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellidos, S_CONTACT.X_DNI AS nif, S_CONTACT.BIRTH_DT AS FECHA_NACIMIENTO, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.SEX_MF AS sexo, S_CONTACT.X_TIPO_VIA AS tipoViaDomicilio, S_CONTACT.X_DIRECCION AS domicilio, S_CONTACT.X_CP AS cpDomicilio, S_CONTACT.X_DIRECCION AS ciudadDomicilio, S_CONTACT.X_PROVINCIA AS provDomicilio, S_ASSET_CON.RELATION_TYPE_CD AS relacionInterviniente, S_CONTACT.X_T_CONT AS tipoContacto, S_CONTACT.X_T_PER AS tipoPersona, S_CONTACT.MARITAL_STAT_CD AS estCivil, S_CONTACT.HOME_PH_NUM AS telContacto1, S_CONTACT.X_DESC_1 AS descTelContacto1, S_CONTACT.WORK_PH_NUM AS telContacto2, S_CONTACT.X_DESC_2 AS descTelContacto2, S_CONTACT.CELL_PH_NUM AS telMovil, S_CONTACT.FAX_PH_NUM AS fax, S_CONTACT.EMAIL_ADDR AS email FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID
sql.intervinientes.detalle.select.first=SELECT S_ASSET.ASSET_NUM AS numPoliza, S_CONTACT.LAST_NAME AS codCliente, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellidos, S_CONTACT.X_DNI AS nif, S_CONTACT.BIRTH_DT AS FECHA_NACIMIENTO, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.SEX_MF AS sexo, S_CONTACT.X_TIPO_VIA AS tipoViaDomicilio, S_CONTACT.X_DIRECCION AS domicilio, S_CONTACT.X_CP AS cpDomicilio, S_CONTACT.X_DIRECCION AS ciudadDomicilio, S_CONTACT.X_PROVINCIA AS provDomicilio, S_ASSET_CON.RELATION_TYPE_CD AS relacionInterviniente, S_CONTACT.X_T_CONT AS tipoContacto, S_CONTACT.X_T_PER AS tipoPersona, S_CONTACT.MARITAL_STAT_CD AS estCivil, S_CONTACT.HOME_PH_NUM AS telContacto1, S_CONTACT.X_DESC_1 AS descTelContacto1, S_CONTACT.WORK_PH_NUM AS telContacto2, S_CONTACT.X_DESC_2 AS descTelContacto2, S_CONTACT.CELL_PH_NUM AS telMovil, S_CONTACT.FAX_PH_NUM AS fax, S_CONTACT.EMAIL_ADDR AS email FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT IS NULL
sql.intervinientes.detalle.select.last=SELECT S_ASSET.ASSET_NUM AS numPoliza, S_CONTACT.LAST_NAME AS codCliente, S_CONTACT.X_NOMBRE AS nombre, S_CONTACT.X_APELLIDOS AS apellidos, S_CONTACT.X_DNI AS nif, S_CONTACT.BIRTH_DT AS FECHA_NACIMIENTO, S_CONTACT.X_DEN_S AS razonSocial, S_CONTACT.SEX_MF AS sexo, S_CONTACT.X_TIPO_VIA AS tipoViaDomicilio, S_CONTACT.X_DIRECCION AS domicilio, S_CONTACT.X_CP AS cpDomicilio, S_CONTACT.X_DIRECCION AS ciudadDomicilio, S_CONTACT.X_PROVINCIA AS provDomicilio, S_ASSET_CON.RELATION_TYPE_CD AS relacionInterviniente, S_CONTACT.X_T_CONT AS tipoContacto, S_CONTACT.X_T_PER AS tipoPersona, S_CONTACT.MARITAL_STAT_CD AS estCivil, S_CONTACT.HOME_PH_NUM AS telContacto1, S_CONTACT.X_DESC_1 AS descTelContacto1, S_CONTACT.WORK_PH_NUM AS telContacto2, S_CONTACT.X_DESC_2 AS descTelContacto2, S_CONTACT.CELL_PH_NUM AS telMovil, S_CONTACT.FAX_PH_NUM AS fax, S_CONTACT.EMAIL_ADDR AS email FROM SIEBEL.S_ASSET, SIEBEL.S_ASSET_CON, SIEBEL.S_CONTACT, SIEBEL.S_POSTN, SIEBEL.S_EMPLOYEE WHERE S_ASSET_CON.ASSET_ID=S_ASSET.ROW_ID AND S_ASSET_CON.RELATION_TYPE_CD = 'ASEGURADO' AND S_ASSET.REV_NUM='0' AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_POSTN.PR_EMP_ID=S_EMPLOYEE.ROW_ID AND S_ASSET_CON.CONTACT_ID=S_CONTACT.ROW_ID AND S_ASSET_CON.END_DT IS NULL AND S_ASSET.ASSET_NUM = '72601888' AND (S_EMPLOYEE.LOGIN = '0420091' OR S_EMPLOYEE.LOGIN = '0821199' OR S_EMPLOYEE.LOGIN = '0821760' OR S_EMPLOYEE.LOGIN ='11111' OR S_EMPLOYEE.LOGIN = '3020197' OR S_EMPLOYEE.LOGIN = '3020730' OR S_EMPLOYEE.LOGIN = '4420703'OR S_EMPLOYEE.LOGIN = '4620077')		
## Mediadores ##
sql.mediadores.detalle.select=SELECT S_EMPLOYEE.LOGIN AS codigoMediador, S_EMPLOYEE.FST_NAME AS nombreMediador, S_EMPLOYEE.LAST_NAME AS apellidosMediador, S_EMPLOYEE.X_DNI AS nifMediador, S_EMPLOYEE.HOME_PH_NUM AS telefono1, S_EMPLOYEE.X_DESC_1 AS descripcionTelefono1, S_EMPLOYEE.WORK_PH_NUM AS telefono2, S_EMPLOYEE.X_DESC_2 AS descripcionTelefono2, S_EMPLOYEE.CELL_PH_NUM AS movil, S_EMPLOYEE.FAX_PH_NUM AS fax, S_EMPLOYEE.EMAIL_ADDR AS email, S_EMPLOYEE.X_RAMO_RESPON AS estadoCE, S_EMPLOYEE.X_F_ALTA_GES AS fechaAlta, S_EMPLOYEE.X_F_BAJA_GES AS fechaBaja, S_EMPLOYEE.X_OFICINA_GES AS OFICINA, S_EMPLOYEE.X_TIPO_VIA AS oficinaTipoVia, S_EMPLOYEE.X_DIRECCION AS oficinaDireccion, S_EMPLOYEE.X_CIUDAD AS oficinaCiudad, S_EMPLOYEE.X_PROVINCIA AS oficinaProvincia, S_EMPLOYEE.X_CP AS oficinaCodigoPostal, S_EMPLOYEE.X_CONEC AS conexionHostMediador, S_EMPLOYEE.SEMINAR_INVIT_FLG AS conexionMediaweb, S_EMPLOYEE.X_IMPRESION_REMOTA AS conexionImpresionRemota, S_EMPLOYEE.X_ECHANNEL AS conexionEChannel, POS_RESP.NAME AS codigoResponsableComercial FROM SIEBEL.S_EMPLOYEE, SIEBEL.S_POSTN POS_MED, SIEBEL.S_POSTN POS_RESP WHERE S_EMPLOYEE.X_T_MEDIADOR='NORMAL' AND S_EMPLOYEE.PR_POSTN_ID=POS_MED.ROW_ID AND POS_RESP.ROW_ID=POS_MED.PAR_POSTN_ID AND S_EMPLOYEE.LOGIN = ? 
sql.mediadores.listado.select=SELECT S_EMPLOYEE.LOGIN AS codigo, S_EMPLOYEE.FST_NAME AS nombre, S_EMPLOYEE.LAST_NAME as apellido, S_EMPLOYEE.X_DNI AS nif, 	S_EMPLOYEE.X_TIPO_VIA AS direccionTipoVia, S_EMPLOYEE.X_DIRECCION AS direccion, S_EMPLOYEE.X_CIUDAD AS direccionCiudad,  S_EMPLOYEE.X_PROVINCIA AS direccionProvincia, S_EMPLOYEE.X_CP AS direccionCodigoPostal, S_EMPLOYEE.HOME_PH_NUM AS telefono,  S_EMPLOYEE.EMAIL_ADDR AS email, CASE WHEN S_EMPLOYEE.X_F_BAJA_GES IS NULL THEN 'ALTA' ELSE 'BAJA' END AS estado, POS_RESP.NAME AS codigoResponsable FROM SIEBEL.S_EMPLOYEE, SIEBEL.S_POSTN POS_MED, SIEBEL.S_POSTN POS_RESP WHERE S_EMPLOYEE.X_T_MEDIADOR='NORMAL' AND S_EMPLOYEE.PR_POSTN_ID=POS_MED.ROW_ID AND POS_RESP.ROW_ID=POS_MED.PAR_POSTN_ID 
sql.mediadores.count.select=SELECT COUNT(S_EMPLOYEE.LOGIN) FROM SIEBEL.S_EMPLOYEE, SIEBEL.S_POSTN POS_MED, SIEBEL.S_POSTN POS_RESP WHERE S_EMPLOYEE.X_T_MEDIADOR='NORMAL' AND S_EMPLOYEE.PR_POSTN_ID=POS_MED.ROW_ID AND POS_RESP.ROW_ID=POS_MED.PAR_POSTN_ID 

## Siniestros ##
sql.siniestros.count.select=SELECT COUNT(S_INS_CLAIM.ROW_ID) FROM SIEBEL.S_ASSET, SIEBEL.S_POSTN, SIEBEL.S_INS_CLAIM, SIEBEL.S_CONTACT WHERE S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_ASSET.ROW_ID=S_INS_CLAIM.ASSET_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID 
sql.siniestros.listado.select=SELECT S_POSTN.NAME AS mediador, S_INS_CLAIM.INSCLAIM_NUM AS numeroSiniestro, S_INS_CLAIM.LOSS_DT AS fechaOcurrencia, S_INS_CLAIM.REPORTED_DT AS fechaDeclaracion, S_INS_CLAIM.SERVICE_DT AS fechaCierre, S_INS_CLAIM.CATASTOPHE_CD AS causa, S_INS_CLAIM.TOTALCLAIM_PAY AS importe, S_CONTACT.X_DNI AS nifCif, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS denominacionSocialTomador, S_INS_CLAIM.STATUS_CD AS estadoSiniestro, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_POSTN, SIEBEL.S_INS_CLAIM, SIEBEL.S_CONTACT WHERE S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_ASSET.ROW_ID=S_INS_CLAIM.ASSET_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID   
sql.siniestros.listado.groupby= 
sql.siniestros.detalle.select=SELECT S_POSTN.NAME AS mediador, S_INS_CLAIM.INSCLAIM_NUM AS numeroSiniestro, S_INS_CLAIM.STATUS_CD AS estadoSiniestro, S_INS_CLAIM.LOSS_DT AS fechaOcurrencia, S_INS_CLAIM.SERVICE_DT AS fechaCierre, S_INS_CLAIM.REPORTED_DT AS fechaDeclaracion, S_INS_CLAIM.RELEASE_DT AS fechaRehabilitacion, S_PROD_INT.X_AGRUPACION AS agrupacion, S_PROD_INT.NAME AS codigoModalidad, S_PROD_INT.ALIAS_NAME AS modalidad, S_ASSET.ASSET_NUM AS poliza, SUM(CASE WHEN S_INSCLM_RECVRY.TYPE='P' THEN S_INSCLM_RECVRY.RECVRY_AMT ELSE 0 END) AS totalPagos, S_INS_CLAIM.CATASTOPHE_CD AS causa, S_CONTACT.X_DNI AS nifCif, S_CONTACT.X_NOMBRE AS nombreTomador, S_CONTACT.X_APELLIDOS AS apellidosTomador, S_CONTACT.X_DEN_S AS denominacionSocialTomador, S_CONTACT.X_TIPO_VIA AS tipoVia, S_CONTACT.X_DIRECCION AS direccion, S_CONTACT.X_CIUDAD AS ciudad, S_CONTACT.X_CP AS codigoPostal, S_CONTACT.X_PROVINCIA AS provincia, S_INS_CLAIM.X_TIPO_RET AS tipoRetencion, S_INS_CLAIM.X_IMPO_RET AS importeRetencion, DECODE(S_INS_CLAIM.TOTALCLAIM_RES,0,0,S_INS_CLAIM.X_IMPO_RET/S_INS_CLAIM.TOTALCLAIM_RES) AS porcentajeRetencion, S_INS_CLAIM.X_RENDI_T_SUJETO AS rendimientoTotalSujeto, S_INS_CLAIM.TOTALCLAIM_RES AS valoracionTotalGarantias, S_ASSET.TYPE_CD AS tipoPoliza FROM SIEBEL.S_ASSET, SIEBEL.S_POSTN, SIEBEL.S_INS_CLAIM, SIEBEL.S_CONTACT, SIEBEL.S_PROD_INT, SIEBEL.S_INSCLM_RECVRY WHERE S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_ASSET.ROW_ID=S_INS_CLAIM.ASSET_ID AND S_ASSET.PR_CON_ID=S_CONTACT.ROW_ID AND S_ASSET.X_PRODUCTO=S_PROD_INT.NAME AND S_INS_CLAIM.ROW_ID=S_INSCLM_RECVRY.INSCLM_ID(+) 
sql.siniestros.detalle.groupby= GROUP BY S_POSTN.NAME, S_INS_CLAIM.INSCLAIM_NUM, S_INS_CLAIM.STATUS_CD, S_INS_CLAIM.LOSS_DT, S_INS_CLAIM.SERVICE_DT, S_INS_CLAIM.REPORTED_DT, S_INS_CLAIM.RELEASE_DT, S_PROD_INT.X_AGRUPACION, S_PROD_INT.NAME, S_PROD_INT.ALIAS_NAME, S_ASSET.ASSET_NUM, S_INS_CLAIM.CATASTOPHE_CD, S_CONTACT.X_DNI, S_CONTACT.X_NOMBRE, S_CONTACT.X_APELLIDOS, S_CONTACT.X_DEN_S, S_CONTACT.X_TIPO_VIA, S_CONTACT.X_DIRECCION, S_CONTACT.X_CIUDAD, S_CONTACT.X_CP, S_CONTACT.X_PROVINCIA, S_INS_CLAIM.X_TIPO_RET , S_INS_CLAIM.X_IMPO_RET, DECODE(S_INS_CLAIM.TOTALCLAIM_RES,0,0,S_INS_CLAIM.X_IMPO_RET/S_INS_CLAIM.TOTALCLAIM_RES), S_INS_CLAIM.X_RENDI_T_SUJETO, S_INS_CLAIM.TOTALCLAIM_RES, S_ASSET.TYPE_CD 

## Pagos Siniestros ##
sql.siniestros.pagos.listado.select=SELECT S_INS_CLAIM.INSCLAIM_NUM AS numeroExpediente, S_INS_CLAIM.CATASTOPHE_CD AS codigoGarantia, S_INSCLM_ELMNT.ELEMENT_TYPE AS descripcionGarantia, S_INSCLM_RECVRY.RECVRY_REC_DT AS fechaPago, S_INSCLM_RECVRY.RECVRY_AMT AS importePago, S_INSCLM_RECVRY.PAYMENT_CD AS tipoPago, S_INSCLM_RECVRY.X_NAT_RECOBRO AS naturalezaPago FROM SIEBEL.S_INS_CLAIM, SIEBEL.S_INSCLM_RECVRY, SIEBEL.S_INSCLM_ELMNT, SIEBEL.S_POSTN WHERE S_INS_CLAIM.ROW_ID=S_INSCLM_RECVRY.INSCLM_ID(+) AND S_INSCLM_RECVRY.ELEMENT_ID=S_INSCLM_ELMNT.ROW_ID(+) 
sql.siniestros.pagos.count.select=SELECT COUNT(S_INS_CLAIM.INSCLAIM_NUM) FROM SIEBEL.S_INS_CLAIM, SIEBEL.S_INSCLM_RECVRY, SIEBEL.S_INSCLM_ELMNT, SIEBEL.S_POSTN WHERE S_INS_CLAIM.ROW_ID=S_INSCLM_RECVRY.INSCLM_ID(+) AND S_INSCLM_RECVRY.ELEMENT_ID=S_INSCLM_ELMNT.ROW_ID(+) 
sql.siniestros.pagos.detalle.select=SELECT S_INS_CLAIM.INSCLAIM_NUM AS numeroExpediente, S_INSCLM_RECVRY.X_CHECK_NUM AS numeroCheque, S_INSCLM_RECVRY.X_CHECK_STATUS_CD AS estadoPago, S_INSCLM_RECVRY.RECVRY_REC_DT AS fechaPago, S_INSCLM_RECVRY.RECVRY_AMT AS importePago, S_INSCLM_RECVRY.X_INVOICE_NUM AS numeroFactura, S_INSCLM_RECVRY.X_F_FIRMADO AS finiquitoFirmado, S_INSCLM_RECVRY.X_ENVIADO_A AS enviadoA, S_POSTN.NAME AS codigoMediacion, S_CONTACT.X_NOMBRE AS nombreReceptor, S_CONTACT.X_APELLIDOS AS apellidosReceptor, S_CONTACT.X_DEN_S AS razonSocialReceptor, S_CONTACT.X_TIPO_VIA AS tipoVia, S_CONTACT.X_DIRECCION AS nombreVia, S_CONTACT.X_CIUDAD AS ciudad, S_CONTACT.X_CP AS codigoPostal, S_CONTACT.X_PROVINCIA AS provincia, S_INSCLM_RECVRY.X_BANCO AS codigoEntidad, S_INSCLM_RECVRY.X_DC AS digitoControl, S_INSCLM_RECVRY.X_CUENTA AS codigoCuenta, S_INSCLM_RECVRY.X_SUCURSAL AS codigoSucursal FROM SIEBEL.S_INS_CLAIM, SIEBEL.S_INSCLM_RECVRY, SIEBEL.S_ASSET, SIEBEL.S_POSTN, SIEBEL.S_CONTACT WHERE S_INS_CLAIM.ROW_ID=S_INSCLM_RECVRY.INSCLM_ID(+) AND S_ASSET.ROW_ID=S_INS_CLAIM.ASSET_ID AND S_ASSET.PR_POSTN_ID=S_POSTN.ROW_ID AND S_INSCLM_RECVRY.X_CON_ID=S_CONTACT.ROW_ID(+) 

 